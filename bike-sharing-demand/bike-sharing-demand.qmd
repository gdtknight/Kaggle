---
title: Bicycle Demand Prediction
jupyter: python3
---

# Bicycle Demand Prediction 

- ì•„ë˜ ë‚´ìš©ì€ 'ë¨¸ì‹ ëŸ¬ë‹â€¢ë”¥ëŸ¬ë‹ ë¬¸ì œí•´ê²°ì „ëµ (ì‹ ë°±ê·  ì €)' `Chap 06` ì‹¤ìŠµ ë‚´ìš© + ì¶”ê°€ ê³µë¶€ ë‚´ìš© ì„ ì •ë¦¬í•œ ê²ƒì…ë‹ˆë‹¤.

```{python}
import os

PROJECT_NAME = "bike-sharing-demand"

def is_kaggle():
    # Kaggle Notebook ì—ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì•„ë˜ envê°€ ì¡´ì¬í•¨
    return (
        os.getenv("KAGGLE_KERNEL_RUN_TYPE") is not None or
        os.path.exists("/kaggle/input")
    )

data_path = None
if is_kaggle():
    print("ğŸ“Œ Kaggle í™˜ê²½ ê°ì§€")

    # Kaggleì¼ ê²½ìš° input ë‚´ë¶€ ëª¨ë“  íŒŒì¼ íƒìƒ‰
    for dirname, _, filenames in os.walk("/kaggle/input"):
        if PROJECT_NAME in dirname:   # competition dataset ë””ë ‰í† ë¦¬ ì°¾ê¸°
            data_path = dirname
            break

    if data_path is None:
        raise FileNotFoundError(f"{PROJECT_NAME} ê´€ë ¨ ë°ì´í„°ë¥¼ Kaggle inputì—ì„œ ì°¾ì§€ ëª»í•¨.")
    else:
        print(f"DATA_PATH = {data_path}")

else:
    print("ğŸ“Œ Local í™˜ê²½ ê°ì§€")

    cwd = os.getcwd()

    print(f"cwd = {cwd}")
    if PROJECT_NAME in cwd:
        data_path = os.path.join(cwd, "input")
    else:
        data_path = os.path.join(cwd, PROJECT_NAME, "input")

    print(f"DATA_PATH = {data_path}")
```

## íƒìƒ‰ì  ë°ì´í„° ë¶„ì„

### ë¼ì´ë¸ŒëŸ¬ë¦¬, ë°ì´í„° íŒŒì¼ ì¤€ë¹„

```{python}
import numpy as np  # ë„˜íŒŒì´ ì„í¬íŠ¸
import pandas as pd  # íŒë‹¤ìŠ¤ ì„í¬íŠ¸

print("data_path =", data_path) 
train = pd.read_csv(os.path.join(data_path, "train.csv"))  # í›ˆë ¨ ë°ì´í„°
test = pd.read_csv(os.path.join(data_path, "test.csv"))  # í…ŒìŠ¤íŠ¸ ë°ì´í„°
submission = pd.read_csv(os.path.join(data_path, "sampleSubmission.csv"))  # ì œì¶œ ìƒ˜í”Œ ë°ì´í„°
```

### í›ˆë ¨ ë°ì´í„°, í…ŒìŠ¤íŠ¸ ë°ì´í„° í¬ê¸° í™•ì¸

```{python}
print("shape - train: ", train.shape, ", test: ", test.shape)
```

### ê° ë°ì´í„°ë³„ Feature í™•ì¸

```{python}
print("[columns]")
print("train - ", train.columns)
print(train.head())
print("test - ", test.columns)
print(test.head())
```

- `train` ë°ì´í„° ì…‹ì—ëŠ” `casual`, `registered` ê°€ ìˆìœ¼ë‚˜ `test` ë°ì´í„°ì…‹ì—ëŠ” ì—†ìŒ

### ì œì¶œ ìƒ˜í”Œ íŒŒì¼ í™•ì¸

```{python}
submission.head()
```

### `DataFrame.info()` ë¥¼ í†µí•œ ê²°ì¸¡ê°’, ë°ì´í„° íƒ€ì… íŒŒì•…

#### `train.info()`

```{python}
train.info()
```

- `train` ë°ì´í„°ì…‹ì— ê²°ì¸¡ì¹˜ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠìŒ

#### `test.info()`

```{python}
test.info()
```

### í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§

#### `datetime feature` ë³€í™˜

##### `datetime feature` í˜•íƒœ í™•ì¸

```{python}
print(train['datetime'][100]) # datetime 100ë²ˆì§¸ ì›ì†Œ
print(train['datetime'][100].split()) # ê³µë°± ê¸°ì¤€ ë¬¸ìì—´ ë‚˜ëˆ„ê¸°
print(train['datetime'][100].split()[0]) # ë‚ ì§œ
print(train['datetime'][100].split()[1]) # ì‹œê°„
print(train['datetime'][100].split()[0].split("-")) # "-" ê¸°ì¤€ìœ¼ë¡œ ë¬¸ìì—´ ë‚˜ëˆ„ê¸°
print(train['datetime'][100].split()[0].split("-")[0]) # ì—°ë„
print(train['datetime'][100].split()[0].split("-")[1]) # ì›”
print(train['datetime'][100].split()[0].split("-")[2]) # ì¼
print(train['datetime'][100].split()[1].split(":")) # "-" ê¸°ì¤€ìœ¼ë¡œ ë¬¸ìì—´ ë‚˜ëˆ„ê¸°
print(train['datetime'][100].split()[1].split(":")[0]) # ì—°ë„
print(train['datetime'][100].split()[1].split(":")[1]) # ì›”
print(train['datetime'][100].split()[1].split(":")[2]) # ì¼
```

##### `datetie feature` ê°€ê³µì„ í†µí•œ ìƒˆë¡œìš´ í”¼ì²˜ ì¶”ê°€

```{python}
from datetime import datetime
import calendar

train["date"] = train["datetime"].apply(lambda x: x.split()[0])  # ë‚ ì§œ í”¼ì²˜ ìƒì„±

# ì—°ë„, ì›”, ì¼, ì‹œ, ë¶„, ì´ˆ í”¼ì²˜ë¥¼ ì°¨ë¡€ë¡œ ìƒì„±
train["year"] = train["datetime"].apply(lambda x: x.split()[0].split("-")[0])
train["month"] = train["datetime"].apply(lambda x: x.split()[0].split("-")[1])
train["day"] = train["datetime"].apply(lambda x: x.split()[0].split("-")[2])
train["hour"] = train["datetime"].apply(lambda x: x.split()[1].split(":")[0])
train["minute"] = train["datetime"].apply(lambda x: x.split()[1].split(":")[1])
train["second"] = train["datetime"].apply(lambda x: x.split()[1].split(":")[2])

train["weekday"] = train["date"].apply(lambda dateString: calendar.day_name[datetime.strptime(dateString, "%Y-%m-%d").weekday()])
```

```{python}
#| trusted: true
#| execution: {iopub.status.busy: '2025-12-04T09:51:09.317179Z', iopub.execute_input: '2025-12-04T09:51:09.317447Z', iopub.status.idle: '2025-12-04T09:51:09.326606Z', shell.execute_reply.started: '2025-12-04T09:51:09.317424Z', shell.execute_reply: '2025-12-04T09:51:09.325529Z'}
train["season(str)"] = train["season"].map(
    {1: "Spring", 2: "Summer", 3: "Fall", 4: "Winter"}
)

train["weather(str)"] = train["weather"].map(
    {
        1: "Clear",
        2: "Mist, Few clouds",
        3: "Light Snow, Rain, Thunderstorm",
        4: "Heavy Rain, Thunderstorm, Snow, Fog",
    }
)
```

```{python}
train.head()
```


### ë°ì´í„° ì‹œê°í™”

#### Library Import

```{python}
import seaborn as sns
import matplotlib as mpl
import matplotlib.pyplot as plt
%matplotlib inline
```

#### ë¶„í¬ë„

```{python}
mpl.rc("font", size=15)  # í°íŠ¸ í¬ê¸°ë¥¼ 15ë¡œ ì„¤ì •
figure, axes = plt.subplots(nrows = 1, ncols = 2)
figure.set_size_inches(20, 10)
sns.histplot(train["count"], ax = axes[0])
sns.histplot(np.log(train["count"]), ax = axes[1])
plt.tight_layout()
```


#### ë§‰ëŒ€ ê·¸ë˜í”„

```{python}
mpl.rc("font", size=14)  #  í°íŠ¸ í¬ê¸° ì„¤ì •
mpl.rc("axes", titlesize=15)  #  ê° ì¶•ì˜ ì œëª© í¬ê¸° ì„¤ì •
figure, axes = plt.subplots(nrows=3, ncols=2)  #  3í–‰ 2ì—´ Figure ìƒì„±
plt.tight_layout()  #  ê·¸ë˜í”„ ì‚¬ì´ì— ì—¬ë°± í™•ë³´
figure.set_size_inches(20, 30)  #  ì „ì²´ Figure í¬ê¸°ë¥¼ 10 x 9 ì¸ì¹˜ë¡œ ì„¤ì •

sns.barplot(x="year", y="count", data=train, ax=axes[0, 0])
sns.barplot(x="month", y="count", data=train, ax=axes[0, 1])
sns.barplot(x="day", y="count", data=train, ax=axes[1, 0])
sns.barplot(x="hour", y="count", data=train, ax=axes[1, 1])
sns.barplot(x="minute", y="count", data=train, ax=axes[2, 0])
sns.barplot(x="second", y="count", data=train, ax=axes[2, 1])

axes[0, 0].set(title="Rental amounts by year")
axes[0, 1].set(title="Rental amounts by month")
axes[1, 0].set(title="Rental amounts by day")
axes[1, 1].set(title="Rental amounts by hour")
axes[2, 0].set(title="Rental amounts by minute")
axes[2, 1].set(title="Rental amounts by second")

axes[1, 0].tick_params(axis="x", labelrotation=90)
axes[1, 1].tick_params(axis="x", labelrotation=90)
```

#### ë°•ìŠ¤í”Œë¡¯

```{python}
# ìŠ¤í… 1: mí–‰ nì—´ Figure ì¤€ë¹„
figure, axes = plt.subplots(nrows=2, ncols=2)
figure.set_size_inches(30, 30)

# ìŠ¤í… 2: ì„œë¸Œí”Œë¡¯ í• ë‹¹
# ê³„ì ˆ, ë‚ ì”¨, ê³µíœ´ì¼, ê·¼ë¬´ì¼ë³„ ëŒ€ì—¬ ìˆ˜ëŸ‰ ë°•ìŠ¤í”Œë¡¯
sns.boxplot(x="season", y="count", data=train, ax=axes[0, 0])
sns.boxplot(x="weather", y="count", data=train, ax=axes[0, 1])
sns.boxplot(x="holiday", y="count", data=train, ax=axes[1, 0])
sns.boxplot(x="workingday", y="count", data=train, ax=axes[1, 1])

# ìŠ¤í… 3: ì„¸ë¶€ ì„¤ì •
# 3-1: ì„œë¸Œí”Œë¡¯ì— ì œëª© ë‹¬ê¸°
axes[0, 0].set(title="Box Plot On Count Across Season")
axes[0, 1].set(title="Box Plot On Count Across Weather")
axes[1, 0].set(title="Box Plot On Count Across Holiday")
axes[1, 1].set(title="Box Plot On Count Across Working Day")

axes[0, 1].tick_params(axis="x", labelrotation=10)

plt.tight_layout()
```

```{python}
#| trusted: true
#| execution: {iopub.status.busy: '2025-12-04T09:51:13.953744Z', iopub.execute_input: '2025-12-04T09:51:13.954107Z', iopub.status.idle: '2025-12-04T09:51:26.397703Z', shell.execute_reply.started: '2025-12-04T09:51:13.954076Z', shell.execute_reply: '2025-12-04T09:51:26.396670Z'}
# ìŠ¤í… 1: mí–‰ nì—´ Figure ì¤€ë¹„
mpl.rc("font", size=11)
figure, axes = plt.subplots(nrows=5)  # 5í–‰ 1ì—´
figure.set_size_inches(12, 18)

# ìŠ¤í… 2: ì„œë¸Œí”Œë¡¯ í• ë‹¹
# ê·¼ë¬´ì¼, ê³µíœ´ì¼, ìš”ì¼, ê³„ì ˆ, ë‚ ì”¨ì— ë”°ë¥¸ ì‹œê°„ëŒ€ë³„ í‰ê·  ëŒ€ì—¬ ìˆ˜ëŸ‰ í¬ì¸íŠ¸í”Œë¡¯
sns.pointplot(x="hour", y="count", data=train, hue="workingday", ax=axes[0])
sns.pointplot(x="hour", y="count", data=train, hue="holiday", ax=axes[1])
sns.pointplot(x="hour", y="count", data=train, hue="weekday", ax=axes[2])
sns.pointplot(x="hour", y="count", data=train, hue="season", ax=axes[3])
sns.pointplot(x="hour", y="count", data=train, hue="weather", ax=axes[4])
```

- `weather` ë¹¨ê°„ìƒ‰ ì ì€ ì´ìƒì¹˜.

```{python}
#| trusted: true
#| execution: {iopub.status.busy: '2025-12-04T09:51:26.398930Z', iopub.execute_input: '2025-12-04T09:51:26.399330Z', iopub.status.idle: '2025-12-04T09:51:29.480032Z', shell.execute_reply.started: '2025-12-04T09:51:26.399293Z', shell.execute_reply: '2025-12-04T09:51:29.479059Z'}
# ìŠ¤í… 1: mí–‰ nì—´ Figure ì¤€ë¹„
mpl.rc("font", size=15)
figure, axes = plt.subplots(nrows=2, ncols=2)  # 2í˜• 2ì—´
figure.set_size_inches(7, 6)

# ìŠ¤í… 2: ì„œë¸Œí”Œë¡¯ í• ë‹¹
# ì˜¨ë„, ì²´ê° ì˜¨ë„, í’ì†, ìŠµë„ ë³„ ëŒ€ì—¬ ìˆ˜ëŸ‰ ì‚°ì ë„ ê·¸ë˜í”„
sns.regplot(
    x="temp",
    y="count",
    data=train,
    ax=axes[0, 0],
    scatter_kws={"alpha": 0.18, "color": "pink"},
    line_kws={"color": "red"},
)
sns.regplot(
    x="atemp",
    y="count",
    data=train,
    ax=axes[0, 1],
    scatter_kws={"alpha": 0.18, "color": "pink"},
    line_kws={"color": "red"},
)
sns.regplot(
    x="windspeed",
    y="count",
    data=train,
    ax=axes[1, 0],
    scatter_kws={"alpha": 0.18, "color": "pink"},
    line_kws={"color": "red"},
)
sns.regplot(
    x="humidity",
    y="count",
    data=train,
    ax=axes[1, 1],
    scatter_kws={"alpha": 0.18, "color": "pink"},
    line_kws={"color": "red"},
)

plt.tight_layout()
```

- `windspeed` ë°ì´í„° ê°’ì´ `0`ì´ ë§ìŒ  - ì‹¤ì œ í’ì†ì´ 0ì´ ì•„ë‹ˆë¼ ê´€ì¸¡ì¹˜ê°€ ì—†ê±°ë‚˜, ì˜¤ë¥˜ë¡œ ì¸í•´ 0ìœ¼ë¡œ ê¸°ë¡ëì„ ê°€ëŠ¥ì„±ì´ ë†’ìŒ.  - ê²°ì¸¡ê°’ì´ ë§ì€ ê²½ìš° ëŒ€ì²´í•˜ê±°ë‚˜ feature ìì²´ë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒì´ ì¢‹ìŒ

```{python}
#| trusted: true
#| execution: {iopub.status.busy: '2025-12-04T09:51:29.481048Z', iopub.execute_input: '2025-12-04T09:51:29.481365Z', iopub.status.idle: '2025-12-04T09:51:29.824335Z', shell.execute_reply.started: '2025-12-04T09:51:29.481331Z', shell.execute_reply: '2025-12-04T09:51:29.823418Z'}
# í”¼ì³ ê°„ ìƒê´€ê´€ê³„ ë§¤íŠ¸ë¦­ìŠ¤
train[["temp", "atemp", "humidity", "windspeed", "count"]].corr()

corrMat = train[["temp", "atemp", "humidity", "windspeed", "count"]].corr()
fig, ax = plt.subplots()
fig.set_size_inches(10, 10)
sns.heatmap(corrMat, annot=True, cmap="Pastel2")  # ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ ê·¸ë¦¬ê¸°
ax.set(title="Heatmap of Numerical Data")
```

## ëª¨ë¸ë§ - ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ (ì„ í˜• íšŒê·€)

### ë°ì´í„°ì…‹ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°

```{python}
import numpy as np  # ë„˜íŒŒì´ ì„í¬íŠ¸
import pandas as pd  # íŒë‹¤ìŠ¤ ì„í¬íŠ¸

print("data_path =", data_path) 
train = pd.read_csv(os.path.join(data_path, "train.csv"))  # í›ˆë ¨ ë°ì´í„°
test = pd.read_csv(os.path.join(data_path, "test.csv"))  # í…ŒìŠ¤íŠ¸ ë°ì´í„°
submission = pd.read_csv(os.path.join(data_path, "sampleSubmission.csv"))  # ì œì¶œ ìƒ˜í”Œ ë°ì´í„°
```

### í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§

#### ì´ìƒì¹˜ ì œê±°

```{python}
# í›ˆë ¨ ë°ì´í„°ì—ì„œ weather ê°€ 4 ê°€ ì•„ë‹Œ ë°ì´í„°ë§Œ ì¶”ì¶œ
train = train[train["weather"] != 4]
```

#### í•™ìŠµ ë°ì´í„°ì…‹, í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ ë³‘í•©

```{python}
# í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ì„ ìœ„í•´ í•™ìŠµìš© ë°ì´í„°, í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ì…‹ ë³‘í•©
all_data = pd.concat([train, test], ignore_index=True)
print(all_data)
```

#### íŒŒìƒ í”¼ì²˜ ì¶”ê°€

```{python}
from datetime import datetime

all_data["date"] = all_data["datetime"].apply(lambda x: x.split()[0])  # 'ë‚ ì§œ' í”¼ì²˜ ìƒì„±
all_data["year"] = all_data["datetime"].apply(lambda x: x.split()[0].split("-")[0])  # 'ì—°ë„' í”¼ì²˜ ìƒì„±
all_data["month"] = all_data["datetime"].apply(lambda x: x.split()[0].split("-")[1])  # 'ì›”' í”¼ì²˜ ìƒì„±
all_data["hour"] = all_data["datetime"].apply(lambda x: x.split()[1].split(":")[0])  # 'ì‹œ' í”¼ì²˜ ìƒì„±
all_data["weekday"] = all_data["date"].apply(lambda dateString: datetime.strptime(dateString, "%Y-%m-%d").weekday())  # 'ìš”ì¼' í”¼ì²˜ ìƒì„±
```

#### ë¶ˆí•„ìš” í”¼ì²˜ ì œê±°

```{python}
drop_features = ["casual", "registered", "datetime", "date", "month", "windspeed"]

all_data = all_data.drop(drop_features, axis=1)
```

#### í•™ìŠµ ë°ì´í„°ì…‹, í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ ë¶„ë¦¬

```{python}
# í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„° ë‚˜ëˆ„ê¸°
X_train = all_data[~pd.isnull(all_data["count"])]
X_test = all_data[pd.isnull(all_data["count"])]

# íƒ€ê¹ƒê°’ count ì œê±°
X_train = X_train.drop(["count"], axis=1)
X_test = X_test.drop(["count"], axis=1)

y = train["count"]  #  íƒ€ê¹ƒê°’

X_train.head()
```

### ëª¨ë¸ í›ˆë ¨

```{python}
#| trusted: true
#| execution: {iopub.status.busy: '2025-12-04T09:51:30.121054Z', iopub.execute_input: '2025-12-04T09:51:30.121418Z', iopub.status.idle: '2025-12-04T09:51:30.160223Z', shell.execute_reply.started: '2025-12-04T09:51:30.121389Z', shell.execute_reply: '2025-12-04T09:51:30.159286Z'}
from sklearn.linear_model import LinearRegression

linear_reg_model = LinearRegression()

log_y = np.log(y)  # íƒ€ê¹ƒê°’ ë¡œê·¸ë³€í™˜
linear_reg_model.fit(X_train, log_y)  # ëª¨ë¸ í›ˆë ¨
```

### í…ŒìŠ¤íŠ¸ ì˜ˆì¸¡

```{python}
#| trusted: true
#| execution: {iopub.status.busy: '2025-12-04T09:51:30.161347Z', iopub.execute_input: '2025-12-04T09:51:30.161628Z', iopub.status.idle: '2025-12-04T09:51:30.176954Z', shell.execute_reply.started: '2025-12-04T09:51:30.161607Z', shell.execute_reply: '2025-12-04T09:51:30.176191Z'}
preds = linear_reg_model.predict(X_train)
```

### ëª¨ë¸ ì„±ëŠ¥ ê²€ì¦

#### í‰ê°€ì§€í‘œ(RMSLE) ê³„ì‚° í•¨ìˆ˜ ì‘ì„±

##### RMSLE (Root Mean Squared Logarithmic Error)

$$\text{RMSLE} = \sqrt{\frac{1}{N} \sum_{i=1}^{N} (\log(p_i + 1) - \log(a_i + 1))^2}$$

- íŠ¹ì§•
  - ì ˆëŒ€ ì˜¤ì°¨ê°€ ì•„ë‹ˆë¼ â€œë¡œê·¸ ë³€í™˜ëœ ê°’ì˜ ì°¨ì´â€ë¥¼ ë³´ê¸° ë•Œë¬¸ì—, ê°’ì˜ í¬ê¸°ë³´ë‹¤ ìƒëŒ€ì ì¸ ë¹„ìœ¨ ì°¨ì´ì— ë” ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•œë‹¤.
  - ê°’ì´ í´ìˆ˜ë¡ ì˜¤ì°¨ê°€ ì»¤ì§€ëŠ” RMSEì— ë¹„í•´, RMSLEëŠ” í° ê°’ì—ì„œì˜ í° ì˜¤ì°¨ ì˜í–¥ì´ ì™„í™”ë˜ê³  ì´ìƒì¹˜ì— ëœ ë¯¼ê°í•œ í¸ì´ë‹¤.
  - ì˜ˆì¸¡ì´ ì‹¤ì œë³´ë‹¤ ì‘ì€ ê²½ìš°(ì–¸ë”í”„ë ˆë”•ì…˜)ì— ë” í° íŒ¨ë„í‹°ë¥¼ ì£¼ëŠ” ê²½í–¥ì´ ìˆì–´, ìˆ˜ìš”Â·ì¬ê³  ì˜ˆì¸¡ì²˜ëŸ¼ ëª¨ìë¼ë©´ ê³¤ë€í•œ ë¬¸ì œì—ì„œ ìì£¼ ì“°ì¸ë‹¤.

- ì–¸ì œ ì‚¬ìš©í•˜ë©´ ì¢‹ì€ê°€
  - íƒ€ê¹ƒì´ 0 ì´ìƒì´ë©° ë¶„í¬ê°€ í•œìª½ìœ¼ë¡œ ì¹˜ìš°ì³ ìˆê³ , ê°’ì˜ ê·œëª¨ê°€ í´ìˆ˜ë¡ ì˜¤ì°¨ì˜ ì ˆëŒ€ê°’ë„ ì»¤ì§€ëŠ” ìˆ˜ìš”Â·ë§¤ì¶œÂ·íŠ¸ë˜í”½ ì˜ˆì¸¡ ê°™ì€ ë¬¸ì œì— ì í•©í•˜ë‹¤.
  - â€œì‹¤ì œì˜ 2ë°°ë¡œ ì˜ˆì¸¡â€ê³¼ â€œì‹¤ì œì˜ ì ˆë°˜ìœ¼ë¡œ ì˜ˆì¸¡â€ì„ ë¹„ìŠ·í•œ ìˆ˜ì¤€ì˜ ì‹¤ìˆ˜ë¡œ ì·¨ê¸‰í•˜ê³  ì‹¶ì„ ë•Œ, ì¦‰ ë¹„ìœ¨ ê¸°ë°˜ ì„±ëŠ¥ì´ ì¤‘ìš”í•œ ê²½ìš°ì— ì í•©í•˜ë‹¤.

```{python}
#| trusted: true
#| execution: {iopub.status.busy: '2025-12-04T09:51:30.112726Z', iopub.execute_input: '2025-12-04T09:51:30.113165Z', iopub.status.idle: '2025-12-04T09:51:30.119799Z', shell.execute_reply.started: '2025-12-04T09:51:30.113137Z', shell.execute_reply: '2025-12-04T09:51:30.118812Z'}
def rmsle(y_true, y_pred, convertExp=True):
    #  ì§€ìˆ˜ë³€í™˜ 1
    if convertExp:
        y_true = np.exp(y_true)
        y_pred = np.exp(y_pred)

    # ë¡œê·¸ë³€í™˜ í›„ ê²°ì¸¡ê°’ì„ 0ìœ¼ë¡œ ë³€í™˜
    log_true = np.nan_to_num(np.log(y_true + 1))
    log_pred = np.nan_to_num(np.log(y_pred + 1))

    # RMSLE ê³„ì‚°
    output = np.sqrt(np.mean((log_true - log_pred) ** 2))

    return output

print(f"ì„ í˜•íšŒê·€ì˜ RMSLE ê°’: {rmsle(log_y, preds, True):.4f}")
```

### ìµœì¢… í…ŒìŠ¤íŠ¸ ì˜ˆì¸¡ ë° ê²°ê³¼ ì œì¶œ

```{python}
#| trusted: true
#| execution: {iopub.status.busy: '2025-12-04T09:51:30.214045Z', iopub.execute_input: '2025-12-04T09:51:30.214484Z', iopub.status.idle: '2025-12-04T09:51:30.274586Z', shell.execute_reply.started: '2025-12-04T09:51:30.214455Z', shell.execute_reply: '2025-12-04T09:51:30.273646Z'}
linearreg_preds = linear_reg_model.predict(X_test)  #  í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ì˜ˆì¸¡

submission["count"] = np.exp(linearreg_preds)  #  ì§€ìˆ˜ë³€í™˜

submission.to_csv("submission.csv", index=False)  #  íŒŒì¼ë¡œ ì €ì¥
```

